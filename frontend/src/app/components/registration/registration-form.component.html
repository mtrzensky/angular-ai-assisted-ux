<h1>Registration / Demo (Speech & Webcam + LLM autofill)</h1>
<form [formGroup]="form" (ngSubmit)="submit()">
  <div class="row">
    <mat-form-field appearance="outline">
      <mat-label>First name</mat-label>
      <input matInput formControlName="firstname" (input)="onInput('firstname', $event)" [matAutocomplete]="autoFirstname">
      <mat-autocomplete #autoFirstname="matAutocomplete" (optionSelected)="applySuggestion('firstname', $event.option.value)">
        <mat-option [value]="s" *ngFor="let s of suggestions$()">{{s}}</mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Last name</mat-label>
      <input matInput formControlName="lastname" (input)="onInput('lastname', $event)">
    </mat-form-field>
  </div>

  <div class="row">
    <mat-form-field appearance="outline">
      <mat-label>Age</mat-label>
      <input matInput formControlName="age" type="number">
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Hair color</mat-label>
      <input matInput formControlName="hairColor" (input)="onInput('hairColor', $event)">
    </mat-form-field>
  </div>

  <mat-form-field appearance="outline" class="full">
    <mat-label>Street</mat-label>
    <input matInput formControlName="street" (input)="onInput('street', $event)">
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>City</mat-label>
    <input matInput formControlName="city" (input)="onInput('city', $event)">
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Country</mat-label>
    <input matInput formControlName="country" (input)="onInput('country', $event)" [matAutocomplete]="autoCountry">
    <mat-autocomplete #autoCountry="matAutocomplete" (optionSelected)="applySuggestion('country', $event.option.value)">
      <mat-option [value]="s" *ngFor="let s of suggestions$()">{{s}}</mat-option>
    </mat-autocomplete>
  </mat-form-field>

  <mat-form-field appearance="outline" class="full">
    <mat-label>Notes</mat-label>
    <textarea matInput formControlName="notes" rows="3"></textarea>
  </mat-form-field>

  <div class="controls">
    <button mat-raised-button type="button" (click)="toggleRecording()">
      <mat-icon>mic</mat-icon> {{ speech.recording() ? 'Stop' : 'Record' }}
    </button>

    <div class="webcam">
      <video #video width="320" height="240" autoplay muted></video>
      <div class="webcam-controls">
        <button mat-stroked-button type="button" (click)="toggleCamera(video)">
          {{ isCameraActive() ? 'Stop Camera' : 'Start Camera' }}
        </button>
        <button mat-stroked-button type="button" (click)="captureAndAnalyze()">Capture & Analyze</button>
      </div>
    </div>

    <button mat-flat-button color="primary" type="submit">Submit</button>
  </div>
</form>

@if (isProcessing()) {
    <div class="processing-overlay">
      <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    </div>
}
